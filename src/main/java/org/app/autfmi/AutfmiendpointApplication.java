package org.app.autfmi;

import jakarta.mail.MessagingException;
import org.app.autfmi.util.Common;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.CommandLineRunner;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

@SpringBootApplication
public class AutfmiendpointApplication implements CommandLineRunner {

    @Autowired
    private Common utilitarios;

    public static void main(String[] args) {
        SpringApplication.run(AutfmiendpointApplication.class, args);
    }


    @Override
    public void run(String... args) throws Exception {
        try {
            String htmlTemplate ="""
            <!DOCTYPE html>
            <html lang="es">
            <head>
                <title>PDF de Prueba</title>
                <style>
                    body {
                        font-family: Arial, sans-serif;
                        font-size: 12px;
                        color: #333;
                        margin: 0;
                        padding: 0;
                    }
                    h1 {
                        font-size: 16px;
                        color: #333;
                        margin: 10px 0;
                    }
                    p {
                        margin: 5px 0;
                    }
                    table {
                        width: 100%;
                        border-collapse: collapse;
                        margin-bottom: 10px;
                    }
                    td {
                        border: 1px solid #ddd;
                    }
                    .label {
                        background-color: #e0dfdf;
                    }
                    th, td {
                        width: 30%;
                        padding: 5px;
                        text-align: left;
                    }
                    table.inner-table {
                        table-layout: fixed;
                        width: 100%;
                    }
                    table.inner-table th,
                    table.inner-table td {
                        width: 33%;
                        border: 1px solid #ddd;
                        padding: 5px;
                    }
                    table.inner-table td {
                        border-left: none;
                        border-bottom: none;
                    }
                    .no-page-break {
                        page-break-inside: avoid;
                    }
                    .no-page-break tr {
                        page-break-inside: avoid;
                    }
                    .no-page-break td {
                        page-break-inside: avoid;
                    }
                    @page {
                        size: A4;
                        margin: 10mm;
                    }
                    .content-container {
                        max-width: 100%;
                        overflow: hidden;
                    }
                </style>
            </head>
            <body>
                <div class="content-container">
                    <table>
                        <tr>
                            <td style="width: 35%; text-align: center;">
                                <svg width="280" height="59" viewBox="0 0 280 59" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path
                                        d="M15.8545 17.2871C16.1415 17.2871 16.3567 17.3588 16.5719 17.574C16.7872 17.7893 16.8589 18.0045 16.8589 18.3632V21.3763C16.8589 21.6632 16.7872 21.8784 16.5719 22.0937C16.4285 22.3089 16.1415 22.3806 15.8545 22.3806H5.0218V28.5503C5.0218 28.909 4.95006 29.1242 4.73484 29.2677C4.51962 29.4111 4.3044 29.5546 4.01744 29.5546H1.0761C0.7174 29.5546 0.50218 29.4829 0.28696 29.2677C0.07174 29.0524 0 28.8372 0 28.5503V2.29342C0 1.64776 0.3587 1.28906 1.00436 1.28906H19.0828C19.3698 1.28906 19.6568 1.3608 19.8002 1.57602C19.9437 1.79124 20.0872 2.00646 20.0872 2.29342V5.3065C20.0872 5.6652 20.0155 5.88042 19.8002 6.09564C19.585 6.31086 19.3698 6.3826 19.0828 6.3826H5.0218V17.2871H15.8545Z"
                                        fill="#0B85C3" />
                                    <path
                                        d="M51.1506 29.6264C50.4332 29.6264 50.0745 29.4112 50.0745 28.909C50.0745 28.6221 50.0745 28.4786 50.0745 28.4069C50.0745 28.3351 50.1462 28.2634 50.1462 28.2634L61.9833 1.28914C62.055 1.14566 62.1985 1.00218 62.2703 0.78696C62.4137 0.57174 62.7724 0.5 63.2746 0.5H63.4898C63.7768 0.5 63.992 0.5 64.1355 0.57174C64.279 0.64348 64.4225 0.71522 64.4942 0.78696C64.4942 0.93044 64.5659 1.07392 64.5659 1.14566C64.5659 1.2174 64.6377 1.36088 64.6377 1.36088C65.5703 3.58482 66.4312 5.5218 67.1486 7.10008C67.866 8.67836 68.5116 10.1132 69.0856 11.3327C69.6595 12.5523 70.2334 13.7002 70.7356 14.7763C71.2378 15.8524 71.8117 17.0002 72.3856 18.2198C72.9595 19.4394 73.6052 20.8742 74.2508 22.4524C74.9682 24.0307 75.7574 25.9677 76.69 28.1916L76.7617 28.4786C76.7617 28.5503 76.8335 28.6938 76.8335 28.7656C76.8335 28.8373 76.8335 28.909 76.8335 28.909C76.8335 29.4112 76.4748 29.6264 75.7574 29.6264H51.1506ZM57.105 24.5329H69.7312L63.2746 9.8262L57.105 24.5329Z"
                                        fill="#FAAB34" />
                                    <path
                                        d="M94.6967 25.609C95.8445 25.609 97.0641 25.3938 98.2119 24.9634C99.3598 24.5329 100.436 23.959 101.369 23.0981C101.512 22.9547 101.655 22.8829 101.871 22.8112C102.086 22.7394 102.229 22.6677 102.445 22.6677C102.732 22.6677 102.947 22.7394 103.09 22.9547L104.74 25.2503C104.812 25.3938 104.884 25.5373 104.884 25.6808C104.884 25.9677 104.812 26.183 104.597 26.3982C104.382 26.6134 104.166 26.8286 104.023 26.9721C102.732 27.9047 101.369 28.6939 99.7902 29.2678C98.2837 29.8417 96.5619 30.1287 94.7684 30.1287C92.7597 30.1287 90.8227 29.77 89.0292 28.9808C87.2357 28.1917 85.6574 27.1873 84.2944 25.8243C82.9313 24.4612 81.927 22.8829 81.1378 21.0894C80.3487 19.2959 79.99 17.3589 79.99 15.3502C79.99 13.3415 80.3487 11.4045 81.1378 9.61102C81.927 7.81752 82.9313 6.23924 84.2944 4.87618C85.6574 3.51312 87.2357 2.50876 89.0292 1.71962C90.8227 0.930477 92.7597 0.571777 94.7684 0.571777C96.275 0.571777 97.7815 0.786997 99.2163 1.28918C100.651 1.79136 102.158 2.50876 103.664 3.58486C104.31 4.0153 104.597 4.51748 104.597 4.94792C104.597 5.16314 104.525 5.30662 104.453 5.4501L102.803 7.88926C102.66 8.17622 102.373 8.31969 102.086 8.31969C102.014 8.31969 101.871 8.24796 101.727 8.17622C101.584 8.10448 101.369 7.961 101.225 7.81752C100.292 7.10012 99.288 6.5262 98.2837 6.09576C97.2076 5.66532 96.0598 5.4501 94.7684 5.4501C93.4054 5.4501 92.0423 5.73706 90.8227 6.23924C89.6031 6.74142 88.527 7.53056 87.5944 8.39144C86.6618 9.32405 85.9444 10.4002 85.4422 11.6197C84.94 12.8393 84.6531 14.1306 84.6531 15.5654C84.6531 16.9285 84.94 18.2916 85.4422 19.5111C85.9444 20.7307 86.6618 21.8068 87.5944 22.7394C88.527 23.6721 89.6031 24.3895 90.8227 24.8916C92.0423 25.3938 93.2619 25.609 94.6967 25.609Z"
                                        fill="#0B85C3" />
                                    <path
                                        d="M129.921 1.28906H108.973C108.471 1.28906 108.256 1.50428 108.256 2.00646V5.44998C108.256 6.0239 108.471 6.31086 108.973 6.31086H116.864V28.5503C116.864 29.1959 117.223 29.5546 117.869 29.5546H120.954C121.671 29.5546 122.03 29.1959 122.03 28.5503V6.31086H129.993C130.208 6.31086 130.423 6.23912 130.567 6.0239C130.71 5.80868 130.71 5.59346 130.71 5.44998V2.00646C130.638 1.50428 130.423 1.28906 129.921 1.28906Z"
                                        fill="#0B85C3" />
                                    <path
                                        d="M129.347 29.6265C128.63 29.6265 128.271 29.4113 128.271 28.9091C128.271 28.6221 128.271 28.4786 128.271 28.4069C128.271 28.3352 128.343 28.2634 128.343 28.2634L140.18 1.36092C140.252 1.21744 140.395 1.07396 140.467 0.858737C140.61 0.643517 140.897 0.571777 141.399 0.571777H141.615C141.902 0.571777 142.117 0.571777 142.26 0.643517C142.404 0.715257 142.547 0.786997 142.619 0.858737C142.691 0.930477 142.762 1.07396 142.762 1.1457C142.762 1.21744 142.834 1.36092 142.834 1.36092C143.767 3.58486 144.628 5.52184 145.345 7.10012C146.063 8.6784 146.708 10.1132 147.282 11.3328C147.856 12.5524 148.43 13.7002 148.932 14.7763C149.434 15.8524 150.008 17.0002 150.582 18.2198C151.156 19.4394 151.802 20.8742 152.447 22.4525C153.165 24.0308 153.954 25.9677 154.887 28.1917L154.958 28.4786C154.958 28.5504 155.03 28.6939 155.03 28.7656C155.03 28.8373 155.03 28.9091 155.03 28.9091C155.03 29.4113 154.671 29.6265 154.026 29.6265H129.347ZM135.373 24.5329H147.999L141.543 9.82624L135.373 24.5329Z"
                                        fill="#FAAB34" />
                                    <path
                                        d="M179.996 24.5328C180.283 24.5328 180.498 24.6046 180.713 24.8198C180.928 25.035 181 25.322 181 25.6089V28.5503C181 28.8372 180.928 29.0524 180.713 29.2677C180.498 29.4829 180.283 29.5546 179.996 29.5546H161.271C160.626 29.5546 160.267 29.1959 160.267 28.5503V2.29342C160.267 2.00646 160.339 1.79124 160.554 1.57602C160.769 1.3608 160.984 1.28906 161.343 1.28906H164.285C164.571 1.28906 164.787 1.3608 165.002 1.57602C165.217 1.7195 165.289 2.00646 165.289 2.29342V24.5328H179.996Z"
                                        fill="#0B85C3" />
                                    <path
                                        d="M42.9724 17.7175C43.618 17.1436 44.1919 16.4262 44.6224 15.7088C45.0528 14.9914 45.4115 14.2023 45.6985 13.3414C45.9137 12.4805 46.0572 11.6196 46.0572 10.7587C46.0572 9.46742 45.842 8.24784 45.3398 7.1C44.8376 5.95216 44.2637 4.9478 43.4028 4.08692C42.5419 3.22604 41.6093 2.50864 40.4615 2.00646C39.3136 1.50428 38.1658 1.28906 36.8027 1.28906H25.8983C25.5396 1.28906 25.5396 1.28906 25.5396 1.57602V28.4785C25.5396 29.1959 25.8983 29.6264 26.6157 29.6264H29.557C29.9157 29.6264 30.1309 29.5546 30.3461 29.3394C30.4896 29.1242 30.5613 28.909 30.5613 28.622V20.0849H35.1527L39.7441 28.4785C39.9593 28.8372 40.1745 29.0524 40.4615 29.2677C40.7484 29.4829 41.1071 29.6264 41.4658 29.6264L44.4072 29.4829C44.6224 29.4829 44.7659 29.4111 44.9811 29.2677C45.1246 29.1242 45.1963 28.9807 45.1963 28.7655C45.1963 28.622 45.1246 28.4068 45.0528 28.2633L40.1745 19.3675L40.8202 19.2241C41.6093 18.7936 42.3267 18.2914 42.9724 17.7175ZM37.0179 15.2784H30.5613V5.88042H37.0179C39.6006 5.88042 41.7528 7.96088 41.7528 10.6153C41.681 13.1979 39.6006 15.2784 37.0179 15.2784Z"
                                        fill="#0B85C3" />
                                    <path opacity="0.5"
                                        d="M68.832 49.4663C68.832 49.1733 68.7865 48.9129 68.6953 48.6851C68.6107 48.4572 68.4577 48.2489 68.2363 48.0601C68.015 47.8713 67.7025 47.689 67.2988 47.5132C66.9017 47.3309 66.3939 47.1453 65.7754 46.9565C65.0983 46.7482 64.4733 46.5171 63.9004 46.2632C63.334 46.0028 62.8392 45.7033 62.416 45.3647C61.9928 45.0197 61.6641 44.6258 61.4297 44.1831C61.1953 43.7339 61.0781 43.2163 61.0781 42.6304C61.0781 42.0509 61.1986 41.5236 61.4395 41.0483C61.6868 40.5731 62.0352 40.1629 62.4844 39.8179C62.9401 39.4663 63.4772 39.1961 64.0957 39.0073C64.7142 38.812 65.3978 38.7144 66.1465 38.7144C67.2012 38.7144 68.1094 38.9097 68.8711 39.3003C69.6393 39.6909 70.2285 40.215 70.6387 40.8726C71.0553 41.5301 71.2637 42.256 71.2637 43.0503H68.832C68.832 42.5815 68.7311 42.1681 68.5293 41.8101C68.334 41.4455 68.0345 41.159 67.6309 40.9507C67.2337 40.7424 66.7292 40.6382 66.1172 40.6382C65.5378 40.6382 65.056 40.7261 64.6719 40.9019C64.2878 41.0776 64.0013 41.3153 63.8125 41.6147C63.6237 41.9142 63.5293 42.2528 63.5293 42.6304C63.5293 42.8973 63.5911 43.1414 63.7148 43.3628C63.8385 43.5776 64.0273 43.7795 64.2812 43.9683C64.5352 44.1506 64.8542 44.3231 65.2383 44.4858C65.6224 44.6486 66.0749 44.8049 66.5957 44.9546C67.3835 45.189 68.0703 45.4494 68.6562 45.7358C69.2422 46.0158 69.7305 46.3348 70.1211 46.6929C70.5117 47.0509 70.8047 47.4578 71 47.9136C71.1953 48.3628 71.293 48.8739 71.293 49.4468C71.293 50.0457 71.1725 50.5861 70.9316 51.0679C70.6908 51.5431 70.3457 51.95 69.8965 52.2886C69.4538 52.6206 68.9199 52.8778 68.2949 53.0601C67.6764 53.2358 66.9863 53.3237 66.2246 53.3237C65.541 53.3237 64.8672 53.2326 64.2031 53.0503C63.5456 52.868 62.9466 52.5913 62.4062 52.2202C61.8659 51.8426 61.4362 51.3739 61.1172 50.814C60.7982 50.2476 60.6387 49.5868 60.6387 48.8315H63.0898C63.0898 49.2938 63.168 49.6877 63.3242 50.0132C63.487 50.3387 63.7116 50.6056 63.998 50.814C64.2845 51.0158 64.6165 51.1655 64.9941 51.2632C65.3783 51.3608 65.7884 51.4097 66.2246 51.4097C66.7975 51.4097 67.276 51.3283 67.6602 51.1655C68.0508 51.0028 68.3438 50.7749 68.5391 50.4819C68.7344 50.189 68.832 49.8504 68.832 49.4663ZM72.7773 47.9624V47.7378C72.7773 46.9761 72.888 46.2697 73.1094 45.6187C73.3307 44.9611 73.6497 44.3914 74.0664 43.9097C74.4896 43.4214 75.0039 43.0438 75.6094 42.7769C76.2214 42.5034 76.9115 42.3667 77.6797 42.3667C78.4544 42.3667 79.1445 42.5034 79.75 42.7769C80.362 43.0438 80.8796 43.4214 81.3027 43.9097C81.7259 44.3914 82.0482 44.9611 82.2695 45.6187C82.4909 46.2697 82.6016 46.9761 82.6016 47.7378V47.9624C82.6016 48.7241 82.4909 49.4305 82.2695 50.0815C82.0482 50.7326 81.7259 51.3022 81.3027 51.7905C80.8796 52.2723 80.3652 52.6499 79.7598 52.9233C79.1543 53.1903 78.4674 53.3237 77.6992 53.3237C76.9245 53.3237 76.2311 53.1903 75.6191 52.9233C75.0137 52.6499 74.4993 52.2723 74.0762 51.7905C73.653 51.3022 73.3307 50.7326 73.1094 50.0815C72.888 49.4305 72.7773 48.7241 72.7773 47.9624ZM75.1309 47.7378V47.9624C75.1309 48.4377 75.1797 48.8869 75.2773 49.3101C75.375 49.7332 75.528 50.1043 75.7363 50.4233C75.9447 50.7424 76.2116 50.993 76.5371 51.1753C76.8626 51.3576 77.25 51.4487 77.6992 51.4487C78.1354 51.4487 78.513 51.3576 78.832 51.1753C79.1576 50.993 79.4245 50.7424 79.6328 50.4233C79.8411 50.1043 79.9941 49.7332 80.0918 49.3101C80.196 48.8869 80.248 48.4377 80.248 47.9624V47.7378C80.248 47.269 80.196 46.8263 80.0918 46.4097C79.9941 45.9865 79.8379 45.6121 79.623 45.2866C79.4147 44.9611 79.1478 44.7072 78.8223 44.5249C78.5033 44.3361 78.1224 44.2417 77.6797 44.2417C77.237 44.2417 76.8529 44.3361 76.5273 44.5249C76.2083 44.7072 75.9447 44.9611 75.7363 45.2866C75.528 45.6121 75.375 45.9865 75.2773 46.4097C75.1797 46.8263 75.1309 47.269 75.1309 47.7378ZM87.0938 38.1284V53.1284H84.7305V38.1284H87.0938ZM96.0293 50.6382V42.562H98.3926V53.1284H96.166L96.0293 50.6382ZM96.3613 48.4409L97.1523 48.4214C97.1523 49.131 97.0742 49.7853 96.918 50.3843C96.7617 50.9767 96.5208 51.4943 96.1953 51.937C95.8698 52.3732 95.4531 52.715 94.9453 52.9624C94.4375 53.2033 93.8288 53.3237 93.1191 53.3237C92.6048 53.3237 92.1328 53.2489 91.7031 53.0991C91.2734 52.9494 90.9023 52.7183 90.5898 52.4058C90.2839 52.0933 90.0462 51.6864 89.877 51.1851C89.7077 50.6838 89.623 50.0848 89.623 49.3882V42.562H91.9766V49.4077C91.9766 49.7918 92.0221 50.1141 92.1133 50.3745C92.2044 50.6284 92.3281 50.8335 92.4844 50.9897C92.6406 51.146 92.8229 51.2567 93.0312 51.3218C93.2396 51.3869 93.4609 51.4194 93.6953 51.4194C94.3659 51.4194 94.8932 51.2892 95.2773 51.0288C95.668 50.7619 95.9447 50.4038 96.1074 49.9546C96.2767 49.5054 96.3613 49.0008 96.3613 48.4409ZM105.121 51.4487C105.505 51.4487 105.85 51.3739 106.156 51.2241C106.469 51.0679 106.719 50.853 106.908 50.5796C107.104 50.3062 107.211 49.9904 107.23 49.6323H109.447C109.434 50.3159 109.232 50.9377 108.842 51.4976C108.451 52.0575 107.934 52.5034 107.289 52.8354C106.645 53.161 105.932 53.3237 105.15 53.3237C104.343 53.3237 103.64 53.187 103.041 52.9136C102.442 52.6336 101.944 52.2495 101.547 51.7612C101.15 51.2729 100.85 50.7098 100.648 50.0718C100.453 49.4338 100.355 48.7502 100.355 48.021V47.6792C100.355 46.95 100.453 46.2664 100.648 45.6284C100.85 44.9839 101.15 44.4175 101.547 43.9292C101.944 43.4409 102.442 43.0601 103.041 42.7866C103.64 42.5067 104.34 42.3667 105.141 42.3667C105.987 42.3667 106.729 42.536 107.367 42.8745C108.005 43.2065 108.507 43.672 108.871 44.271C109.242 44.8634 109.434 45.5535 109.447 46.3413H107.23C107.211 45.9507 107.113 45.5991 106.938 45.2866C106.768 44.9676 106.527 44.7137 106.215 44.5249C105.909 44.3361 105.541 44.2417 105.111 44.2417C104.636 44.2417 104.242 44.3394 103.93 44.5347C103.617 44.7235 103.373 44.9839 103.197 45.3159C103.021 45.6414 102.895 46.0093 102.816 46.4194C102.745 46.8231 102.709 47.243 102.709 47.6792V48.021C102.709 48.4572 102.745 48.8804 102.816 49.2905C102.888 49.7007 103.012 50.0685 103.188 50.394C103.37 50.7131 103.617 50.9702 103.93 51.1655C104.242 51.3543 104.639 51.4487 105.121 51.4487ZM113.773 42.562V53.1284H111.41V42.562H113.773ZM111.254 39.7886C111.254 39.4305 111.371 39.1343 111.605 38.8999C111.846 38.659 112.178 38.5386 112.602 38.5386C113.018 38.5386 113.347 38.659 113.588 38.8999C113.829 39.1343 113.949 39.4305 113.949 39.7886C113.949 40.1401 113.829 40.4331 113.588 40.6675C113.347 40.9019 113.018 41.019 112.602 41.019C112.178 41.019 111.846 40.9019 111.605 40.6675C111.371 40.4331 111.254 40.1401 111.254 39.7886ZM115.902 47.9624V47.7378C115.902 46.9761 116.013 46.2697 116.234 45.6187C116.456 44.9611 116.775 44.3914 117.191 43.9097C117.615 43.4214 118.129 43.0438 118.734 42.7769C119.346 42.5034 120.036 42.3667 120.805 42.3667C121.579 42.3667 122.27 42.5034 122.875 42.7769C123.487 43.0438 124.005 43.4214 124.428 43.9097C124.851 44.3914 125.173 44.9611 125.395 45.6187C125.616 46.2697 125.727 46.9761 125.727 47.7378V47.9624C125.727 48.7241 125.616 49.4305 125.395 50.0815C125.173 50.7326 124.851 51.3022 124.428 51.7905C124.005 52.2723 123.49 52.6499 122.885 52.9233C122.279 53.1903 121.592 53.3237 120.824 53.3237C120.049 53.3237 119.356 53.1903 118.744 52.9233C118.139 52.6499 117.624 52.2723 117.201 51.7905C116.778 51.3022 116.456 50.7326 116.234 50.0815C116.013 49.4305 115.902 48.7241 115.902 47.9624ZM118.256 47.7378V47.9624C118.256 48.4377 118.305 48.8869 118.402 49.3101C118.5 49.7332 118.653 50.1043 118.861 50.4233C119.07 50.7424 119.337 50.993 119.662 51.1753C119.988 51.3576 120.375 51.4487 120.824 51.4487C121.26 51.4487 121.638 51.3576 121.957 51.1753C122.283 50.993 122.549 50.7424 122.758 50.4233C122.966 50.1043 123.119 49.7332 123.217 49.3101C123.321 48.8869 123.373 48.4377 123.373 47.9624V47.7378C123.373 47.269 123.321 46.8263 123.217 46.4097C123.119 45.9865 122.963 45.6121 122.748 45.2866C122.54 44.9611 122.273 44.7072 121.947 44.5249C121.628 44.3361 121.247 44.2417 120.805 44.2417C120.362 44.2417 119.978 44.3361 119.652 44.5249C119.333 44.7072 119.07 44.9611 118.861 45.2866C118.653 45.6121 118.5 45.9865 118.402 46.4097C118.305 46.8263 118.256 47.269 118.256 47.7378ZM130.033 44.8179V53.1284H127.68V42.562H129.896L130.033 44.8179ZM129.613 47.4546L128.852 47.4448C128.858 46.6961 128.962 46.0093 129.164 45.3843C129.372 44.7593 129.659 44.2222 130.023 43.7729C130.395 43.3237 130.837 42.9787 131.352 42.7378C131.866 42.4904 132.439 42.3667 133.07 42.3667C133.578 42.3667 134.037 42.4383 134.447 42.5815C134.864 42.7183 135.219 42.9429 135.512 43.2554C135.811 43.5679 136.039 43.9748 136.195 44.4761C136.352 44.9709 136.43 45.5796 136.43 46.3022V53.1284H134.066V46.2925C134.066 45.7847 133.992 45.3843 133.842 45.0913C133.699 44.7918 133.487 44.5802 133.207 44.4565C132.934 44.3263 132.592 44.2612 132.182 44.2612C131.778 44.2612 131.417 44.3459 131.098 44.5151C130.779 44.6844 130.508 44.9155 130.287 45.2085C130.072 45.5015 129.906 45.84 129.789 46.2241C129.672 46.6082 129.613 47.0184 129.613 47.4546ZM143.49 53.3237C142.709 53.3237 142.003 53.1968 141.371 52.9429C140.746 52.6825 140.212 52.3211 139.77 51.8589C139.333 51.3966 138.998 50.853 138.764 50.228C138.529 49.603 138.412 48.9292 138.412 48.2065V47.8159C138.412 46.9891 138.533 46.2404 138.773 45.5698C139.014 44.8993 139.35 44.3263 139.779 43.8511C140.209 43.3693 140.717 43.0015 141.303 42.7476C141.889 42.4937 142.523 42.3667 143.207 42.3667C143.962 42.3667 144.623 42.4937 145.189 42.7476C145.756 43.0015 146.225 43.3595 146.596 43.8218C146.973 44.2775 147.253 44.8211 147.436 45.4526C147.624 46.0841 147.719 46.7808 147.719 47.5425V48.5483H139.555V46.8589H145.395V46.6733C145.382 46.2502 145.297 45.853 145.141 45.4819C144.991 45.1108 144.76 44.8114 144.447 44.5835C144.135 44.3556 143.718 44.2417 143.197 44.2417C142.807 44.2417 142.458 44.3263 142.152 44.4956C141.853 44.6584 141.602 44.896 141.4 45.2085C141.199 45.521 141.042 45.8986 140.932 46.3413C140.827 46.7775 140.775 47.269 140.775 47.8159V48.2065C140.775 48.6688 140.837 49.0985 140.961 49.4956C141.091 49.8862 141.28 50.228 141.527 50.521C141.775 50.814 142.074 51.0451 142.426 51.2144C142.777 51.3771 143.178 51.4585 143.627 51.4585C144.193 51.4585 144.698 51.3446 145.141 51.1167C145.583 50.8888 145.967 50.5666 146.293 50.1499L147.533 51.3511C147.305 51.6831 147.009 52.0021 146.645 52.3081C146.28 52.6076 145.834 52.8517 145.307 53.0405C144.786 53.2293 144.18 53.3237 143.49 53.3237ZM155.482 50.2671C155.482 50.0327 155.424 49.8211 155.307 49.6323C155.189 49.437 154.965 49.2612 154.633 49.105C154.307 48.9487 153.826 48.8055 153.188 48.6753C152.628 48.5516 152.113 48.4051 151.645 48.2358C151.182 48.0601 150.785 47.8485 150.453 47.6011C150.121 47.3537 149.864 47.0607 149.682 46.7222C149.499 46.3836 149.408 45.993 149.408 45.5503C149.408 45.1206 149.503 44.7137 149.691 44.3296C149.88 43.9455 150.15 43.6069 150.502 43.314C150.854 43.021 151.28 42.7899 151.781 42.6206C152.289 42.4513 152.855 42.3667 153.48 42.3667C154.366 42.3667 155.124 42.5164 155.756 42.8159C156.394 43.1089 156.882 43.5093 157.221 44.0171C157.559 44.5184 157.729 45.0848 157.729 45.7163H155.375C155.375 45.4364 155.303 45.1759 155.16 44.9351C155.023 44.6877 154.815 44.4891 154.535 44.3394C154.255 44.1831 153.904 44.105 153.48 44.105C153.077 44.105 152.742 44.1701 152.475 44.3003C152.214 44.424 152.019 44.5868 151.889 44.7886C151.765 44.9904 151.703 45.2118 151.703 45.4526C151.703 45.6284 151.736 45.7879 151.801 45.9312C151.872 46.0679 151.99 46.1948 152.152 46.312C152.315 46.4227 152.536 46.5269 152.816 46.6245C153.103 46.7222 153.461 46.8166 153.891 46.9077C154.698 47.077 155.391 47.2951 155.971 47.562C156.557 47.8224 157.006 48.161 157.318 48.5776C157.631 48.9878 157.787 49.5086 157.787 50.1401C157.787 50.6089 157.686 51.0386 157.484 51.4292C157.289 51.8133 157.003 52.1486 156.625 52.4351C156.247 52.715 155.795 52.9331 155.268 53.0894C154.747 53.2456 154.161 53.3237 153.51 53.3237C152.553 53.3237 151.742 53.1545 151.078 52.8159C150.414 52.4709 149.91 52.0314 149.564 51.4976C149.226 50.9572 149.057 50.3973 149.057 49.8179H151.332C151.358 50.2541 151.479 50.6024 151.693 50.8628C151.915 51.1167 152.188 51.3022 152.514 51.4194C152.846 51.5301 153.188 51.5854 153.539 51.5854C153.962 51.5854 154.317 51.5301 154.604 51.4194C154.89 51.3022 155.108 51.146 155.258 50.9507C155.408 50.7489 155.482 50.521 155.482 50.2671ZM170.443 38.9097V53.1284H168.012V38.9097H170.443ZM174.906 38.9097V40.8628H163.588V38.9097H174.906ZM179.398 38.9097V53.1284H176.947V38.9097H179.398Z"
                                        fill="#142D57" />
                                </svg>
                            </td>
                            <td style="text-align: center; width: 35%; font-weight: bold;">FORMULARIO DE MOVIMIENTO</td>
                            <td style="padding: 0;">
                                <table>
                                    <tr>
                                        <td>Código</td>
                                        <td>FT-GTH-12</td>
                                    </tr>
                                    <tr>
                                        <td>Versión</td>
                                        <td>02</td>
                                    </tr>
                                    <tr>
                                        <td>Fecha</td>
                                        <td>{{fecha}}</td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                    </table>

                    <h1>DATOS DEL COLABORADOR</h1>
                    <table class="no-page-break">
                        <tr>
                            <th class="label">Nombres y Apellidos</th>
                            <td>{{nombres}} {{apellidos}}</td>
                        </tr>
                        <tr>
                            <th class="label">Unidad</th>
                            <td>{{unidad}}</td>
                        </tr>
                    </table>

                    <h1>INGRESO</h1>
                    <table class="no-page-break">
                        <tr>
                            <th class="label">Modalidad</th>
                            <td>{{modalidad}}</td>
                        </tr>
                        <tr>
                            <th class="label">Motivo de Ingreso</th>
                            <td>{{motivoIngreso}}</td>
                        </tr>
                        <tr>
                            <th class="label">Cargo</th>
                            <td>{{cargo}}</td>
                        </tr>
                        <tr>
                            <th class="label">Horario de Trabajo</th>
                            <td>{{horarioTrabajo}}</td>
                        </tr>
                        <tr>
                            <th class="label">Estructura Salarial</th>
                            <td style="padding: 0;">
                                <table class="inner-table">
                                    <tr>
                                        <th>Base</th>
                                        <th>Movilidad</th>
                                        <th>Bono Trimestral</th>
                                    </tr>
                                    <tr>
                                        <td>{{montoBase}}</td>
                                        <td>{{montoMovilidad}}</td>
                                        <td>{{montoTrimestral}}</td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <th class="label">F. Inicio contrato</th>
                            <td>{{fechaInicioContrato}}</td>
                        </tr>
                        <tr>
                            <th class="label">F. Término contrato</th>
                            <td>{{fechaTerminoContrato}}</td>
                        </tr>
                        <tr>
                            <th class="label">Proyecto / servicio</th>
                            <td>{{proyectoServicio}}</td>
                        </tr>
                        <tr>
                            <th class="label">Objeto del contrato</th>
                            <td>{{objetoContrato}}</td>
                        </tr>
                    </table>

                    <h1>DECLARACIÓN EN SUNAT (*)</h1>
                    <table class="no-page-break">
                        <tr>
                            <th class="label">[1] ¿Declarado en Sunat?</th>
                            <td>{{declaradoSunat}}</td>
                        </tr>
                        <tr>
                            <th class="label">[2] Sede a declarar</th>
                            <td>{{sedeDeclarar}}</td>
                        </tr>
                    </table>

                    <h1>MOVIMIENTO</h1>
                    <table class="no-page-break">
                        <tr>
                            <th class="label">Estructura Salarial</th>
                            <td style="padding: 0;">
                                <table class="inner-table">
                                    <tr>
                                        <th>Base</th>
                                        <th>Movilidad</th>
                                        <th>Bono Trimestral</th>
                                    </tr>
                                    <tr>
                                        <td>{{montoBase}}</td>
                                        <td>{{montoMovilidad}}</td>
                                        <td>{{montoTrimestral}}</td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <th class="label">Cambio de puesto</th>
                            <td>{{puesto}}</td>
                        </tr>
                        <tr>
                            <th class="label">Cambio de área</th>
                            <td>{{area}}</td>
                        </tr>
                        <tr>
                            <th class="label">Cambio de jornada</th>
                            <td>{{jornada}}</td>
                        </tr>
                        <tr>
                            <th class="label">F. Inicio de movimiento</th>
                            <td>{{fechaMovimiento}}</td>
                        </tr>
                    </table>

                    <h1>CESE</h1>
                    <table style="margin-bottom: 50px;">
                        <tr>
                            <th class="label">Motivo de Cese</th>
                            <td>{{motivoCese}}</td>
                        </tr>
                        <tr>
                            <th class="label">Fecha de Cese</th>
                            <td>{{fechaCese}}</td>
                        </tr>
                    </table>

                    <table style="margin-bottom: 20px;">
                        <tr style="border: none;">
                            <td style="width: 100%; text-align: center; border: none;">
                                <p>_________________________________________</p>
                                <p>{{firmante}}</p>
                                <p>{{Gestor de Servicios}}</p>
                            </td>
                        </tr>
                    </table>

                    <p style="text-align: justify; font-size: 10px;">
                        (*) DECLARACION EN SUNAT - En esta sección deberá informar al colaborador que se encuentra en Planilla
                        y será declarado en SUNAT. Responda la pregunta [1], en caso su respuesta sea afirmativa, por favor
                        responda a la pregunta [2] tener en cuenta que si la respuesta es "Oficina del Cliente" se debe
                        contar con un contrato entre empresas.
                    </p>
                </div>
            </body>
            </html>
        """;
//            String nombre = "Usuario Test";
//            double saldo = 1000.50;
//
//            String htmlConDatos = utilitarios.reemplazarValores(htmlTemplate, nombre, saldo);

            utilitarios.enviarCorreoConPDF(
                    htmlTemplate,
                    "max.cardenas.cas@gmail.com",
                    "Prueba correo",
                    """
                            Hola\s

                            Se realizó una actualización del talento, por favor revise el documento."""
            );
        } catch (MessagingException e) {
            e.printStackTrace();
            System.out.println("Error al enviar el correo: " + e.getMessage());
        }
    }
}
